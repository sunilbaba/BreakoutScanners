
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Ultra Scanner</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://unpkg.com/lucide@latest"></script>
        <style>
            body { background-color: #0f172a; color: #e2e8f0; font-family: sans-serif; }
            .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 50; backdrop-filter: blur(5px); }
            .modal-content { background: #1e293b; margin: 5vh auto; width: 95%; max-width: 600px; max-height: 90vh; overflow-y: auto; border-radius: 12px; border: 1px solid #334155; }
            
            .dot { height: 8px; width: 8px; border-radius: 50%; display: inline-block; margin-right: 2px; }
            .dot-up { background-color: #4ade80; box-shadow: 0 0 5px #4ade80; }
            .dot-down { background-color: #f87171; opacity: 0.4; }
            
            .b-std { background: rgba(59, 130, 246, 0.15); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.3); }
            .b-gold { background: rgba(250, 204, 21, 0.15); color: #facc15; border: 1px solid rgba(250, 204, 21, 0.3); }
            .b-nr7 { background: rgba(236, 72, 153, 0.15); color: #f472b6; border: 1px solid rgba(236, 72, 153, 0.3); }
            .b-div { background: #ec4899; color: white; box-shadow: 0 0 8px #ec4899; }
            
            .v-green { color: #4ade80; border: 1px solid #4ade80; background: rgba(74, 222, 128, 0.1); }
            .v-blue { color: #60a5fa; border: 1px solid #60a5fa; background: rgba(96, 165, 250, 0.1); }
            .v-orange { color: #fb923c; border: 1px solid #fb923c; background: rgba(251, 146, 60, 0.1); }
        </style>
    </head>
    <body>
        <div class="max-w-7xl mx-auto p-4">
            <!-- HEADER -->
            <header class="mb-4 border-b border-slate-700 pb-4">
                <div class="flex justify-between items-end mb-4">
                    <div>
                        <h1 class="text-2xl font-bold text-blue-400 flex items-center gap-2"><i data-lucide="zap"></i> Ultra Scanner</h1>
                        <div class="flex items-center gap-2 text-xs mt-1 text-slate-400">
                            <span class="text-green-400 font-bold">ADV {RAW.stats.adv}</span> / <span class="text-red-400 font-bold">DEC {RAW.stats.dec}</span>
                            <span>• NIFTY {RAW.stats.nifty}%</span>
                        </div>
                    </div>
                </div>
                <!-- SECTORS -->
                <div class="flex gap-2 overflow-x-auto pb-2">
                    {RAW.sectors.map(s => (
                        <div class="bg-slate-800 px-3 py-1.5 rounded border border-slate-700 whitespace-nowrap">
                            <span class="text-[10px] text-slate-400 mr-2">{s.name}</span>
                            <span class="font-bold text-xs ${s.avg >= 0 ? 'text-green-400' : 'text-red-400'}">{s.avg}%</span>
                        </div>
                    ))}
                </div>
                <!-- FILTERS -->
                <div class="flex bg-slate-800 p-1 rounded-lg mt-3 overflow-x-auto gap-1">
                    <button onclick="setFilter('ALL')" id="btn-all" class="px-4 py-1.5 rounded text-xs font-bold bg-blue-600 text-white">All</button>
                    <button onclick="setFilter('PRIME')" id="btn-prime" class="px-4 py-1.5 rounded text-xs font-bold text-slate-400">Prime Buy</button>
                    <button onclick="setFilter('FNO')" id="btn-fno" class="px-4 py-1.5 rounded text-xs font-bold text-slate-400">F&O</button>
                    <button onclick="setFilter('RS')" id="btn-rs" class="px-4 py-1.5 rounded text-xs font-bold text-slate-400">Strong RS</button>
                </div>
            </header>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="grid"></div>
        </div>

        <!-- MODAL -->
        <div id="modal" class="modal">
            <div class="modal-content">
                <div class="sticky top-0 bg-slate-800 p-4 border-b border-slate-700 flex justify-between items-center">
                    <div><h2 id="m-sym" class="text-2xl font-bold text-white">SYMBOL</h2></div>
                    <button onclick="closeModal()" class="p-2 bg-slate-700 rounded-full hover:bg-slate-600"><i data-lucide="x"></i></button>
                </div>
                <div class="p-6 space-y-6">
                    <div class="bg-slate-800 p-4 rounded-xl border border-slate-700">
                        <h3 class="text-xs text-slate-500 uppercase mb-2">Analysis Verdict</h3>
                        <ul id="m-reasons" class="list-disc list-inside text-sm text-slate-300 space-y-1"></ul>
                        <div class="mt-3 pt-3 border-t border-slate-700 flex justify-between text-sm">
                            <span class="text-slate-500">SCORE</span><span id="m-score" class="font-bold text-white">0/100</span>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-green-900/20 border border-green-500/30 p-3 rounded text-center">
                            <div class="text-xs text-green-400 font-bold">TARGET</div><div id="m-tgt" class="text-xl font-bold text-white">0</div>
                        </div>
                        <div class="bg-red-900/20 border border-red-500/30 p-3 rounded text-center">
                            <div class="text-xs text-red-400 font-bold">STOP</div><div id="m-sl" class="text-xl font-bold text-white">0</div>
                        </div>
                    </div>
                    <div class="bg-slate-800 p-3 rounded border border-slate-700 flex justify-between text-sm">
                        <div class="text-center"><div class="text-red-400">R1</div><div id="m-r1">0</div></div>
                        <div class="text-center border-x border-slate-600 px-4"><div class="text-blue-400">Pivot</div><div id="m-p">0</div></div>
                        <div class="text-center"><div class="text-green-400">S1</div><div id="m-s1">0</div></div>
                    </div>
                    <!-- Logs -->
                    <div class="overflow-hidden rounded border border-slate-700">
                        <table class="w-full text-xs">
                            <thead class="bg-slate-900 text-slate-300"><tr><th class="p-2 text-left">Date</th><th class="p-2 text-right">Entry</th><th class="p-2 text-right">Result</th><th class="p-2 text-right">P&L</th></tr></thead>
                            <tbody id="m-logs" class="bg-slate-800 text-slate-300 divide-y divide-slate-700/50"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <script>
            const RAW = {"stocks": [], "sectors": [], "stats": {"adv": 0, "dec": 0, "nifty": -0.42}};
            const data = RAW.stocks;
            let currentFilter = 'ALL';
            lucide.createIcons();
            
            function setFilter(type) {
                currentFilter = type;
                ['btn-all','btn-fno','btn-rs','btn-prime'].forEach(id => document.getElementById(id).className = "px-4 py-1.5 rounded text-xs font-bold text-slate-400 hover:text-white transition");
                document.getElementById('btn-'+type.toLowerCase()).className = "px-4 py-1.5 rounded text-xs font-bold bg-blue-600 text-white transition";
                render();
            }

            function render() {
                const grid = document.getElementById('grid');
                grid.innerHTML = '';
                
                const filtered = data.filter(s => {
                    if(currentFilter === 'FNO') return s.is_fno;
                    if(currentFilter === 'RS') return s.rs > 1.5;
                    if(currentFilter === 'PRIME') return s.verdict === 'PRIME BUY';
                    return true;
                });

                if(filtered.length === 0) grid.innerHTML = '<div class="col-span-3 text-center text-slate-500 p-10">No results.</div>';

                filtered.forEach((s, i) => {
                    // Dots
                    const mDot = s.trends.M === 'UP' ? 'dot-up' : 'dot-down';
                    const wDot = s.trends.W === 'UP' ? 'dot-up' : 'dot-down';
                    const dDot = s.trends.D === 'UP' ? 'dot-up' : 'dot-down';
                    
                    // Verdict Class
                    let vClass = 'v-orange';
                    if(s.v_color === 'green') vClass = 'v-green';
                    if(s.v_color === 'blue') vClass = 'v-blue';
                    if(s.v_color === 'red') vClass = 'text-red-500 border border-red-500 bg-red-900/20';

                    // Badges
                    let badges = '';
                    if(s.is_fno) badges += `<span class="bg-blue-900/50 text-blue-300 border border-blue-500/30 px-1.5 py-0.5 rounded text-[10px] font-bold mr-1">F&O</span>`;
                    if(s.buzz > 0) badges += `<span class="bg-orange-900/50 text-orange-300 border border-orange-500/30 px-1.5 py-0.5 rounded text-[10px] font-bold mr-1 flex items-center gap-1 inline-flex"><i data-lucide="flame" class="w-3"></i>${s.buzz}</span>`;
                    
                    s.signals.forEach(sig => {
                        let cls = 'b-std';
                        if(sig.includes('NR7')) cls = 'b-nr7';
                        if(sig.includes('Divergence')) cls = 'b-div';
                        if(sig.includes('Golden')) cls = 'b-gold';
                        badges += `<span class="${cls} px-1.5 py-0.5 rounded text-[10px] font-bold uppercase mr-1 mb-1 inline-block">${sig}</span>`;
                    });

                    const pts = s.history.map((d, j) => {
                        const min = Math.min(...s.history); const max = Math.max(...s.history);
                        const x = (j / (s.history.length - 1)) * 100;
                        const y = 30 - ((d - min) / (max - min || 1)) * 30;
                        return `${x},${y}`;
                    }).join(' ');

                    grid.innerHTML += `
                        <div class="card bg-slate-800 p-4 rounded-xl border border-slate-700 shadow-lg relative group" onclick="openModal('${s.symbol}')">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <div class="flex items-center gap-2">
                                        <div class="font-bold text-lg text-white group-hover:text-blue-400 transition">${s.symbol}</div>
                                        <span class="text-[10px] text-slate-500 border border-slate-600 px-1 rounded">${s.sector.substring(0,10)}</span>
                                    </div>
                                    <div class="text-xs text-slate-400 font-mono mt-1">₹${s.price} <span class="${s.change>=0?'text-green-400':'text-red-400'} ml-1">${s.change}%</span></div>
                                </div>
                                <div class="text-right">
                                    <div class="px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider ${vClass}">${s.verdict}</div>
                                    <div class="mt-1"><span class="dot ${mDot}"></span><span class="dot ${wDot}"></span><span class="dot ${dDot}"></span></div>
                                </div>
                            </div>
                            
                            <div class="flex flex-wrap gap-1 mb-3 min-h-[1.5rem] content-start">${badges}</div>
                            
                            <div class="h-8 w-full opacity-60">
                                <svg width="100%" height="100%" preserveAspectRatio="none" class="overflow-visible"><polyline points="${pts}" fill="none" stroke="${s.change >= 0 ? '#4ade80' : '#f87171'}" stroke-width="2" /></svg>
                            </div>
                        </div>
                    `;
                });
                lucide.createIcons();
            }

            function openModal(sym) {
                const s = data.find(x => x.symbol === sym);
                document.getElementById('m-sym').innerText = s.symbol;
                document.getElementById('m-tgt').innerText = s.levels.TGT;
                document.getElementById('m-sl').innerText = s.levels.SL;
                document.getElementById('m-r1').innerText = s.levels.R1;
                document.getElementById('m-p').innerText = s.levels.P;
                document.getElementById('m-s1').innerText = s.levels.S1;
                document.getElementById('m-score').innerText = s.score + '/100';
                
                const list = document.getElementById('m-reasons');
                list.innerHTML = '';
                s.reasons.forEach(r => list.innerHTML += `<li>${r}</li>`);
                
                let rows = '';
                const bt = s.backtest;
                if(bt.log.length === 0) rows = '<tr><td colspan="4" class="p-4 text-center italic text-slate-500">No recent signals.</td></tr>';
                else {
                    [...bt.log].reverse().forEach(l => {
                        let c = l.result.includes('WIN') ? 'text-green-400 font-bold' : (l.result.includes('LOSS') ? 'text-red-400' : 'text-yellow-400');
                        rows += `<tr class="hover:bg-slate-700/50"><td class="p-2">${l.date}</td><td class="p-2 text-right font-mono">${l.entry}</td><td class="p-2 text-right ${c} text-[10px]">${l.result}</td><td class="p-2 text-right font-mono ${c}">${l.pnl}%</td></tr>`;
                    });
                }
                document.getElementById('m-logs').innerHTML = rows;
                document.getElementById('modal').style.display = 'block';
            }
            
            function closeModal() { document.getElementById('modal').style.display = 'none'; }
            window.onclick = function(e) { if(e.target == document.getElementById('modal')) closeModal(); }
            
            render();
        </script>
    </body>
    </html>
    